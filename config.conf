[leblebi]
# ============================================================================
# ALERT FILTERING SETTINGS
# ============================================================================

# Alert severity threshold level (integer, 0-15)
# Only alerts with level >= this value will be considered "critical"
# Recommended values:
#   - 12: Standard security monitoring (default)
#   - 10: More sensitive monitoring
#   - 15: Only highest severity alerts
#   - 8: Include more alerts in analysis
level = 12

# Maximum number of top alerts to display in reports (integer)
# This limits the number of alerts shown in "Top Alerts" sections
# Recommended: 50-200 for readable reports
# Options: Any positive integer (default: 100)
top_alerts_count = 100

# ============================================================================
# DIRECTORY SETTINGS
# ============================================================================

# Directory where Wazuh alert logs are stored
# This is where Leblebi will look for alerts.json file
# Options: Any valid directory path
# Default: /var/ossec/logs/alerts
log_dir = /var/ossec/logs/alerts

# Directory where generated reports will be saved
# Options: Any valid directory path (must be writable)
# Default: /var/ossec/logs/reports
output_dir = /var/ossec/logs/reports

# ============================================================================
# EMAIL CONFIGURATION
# ============================================================================

# SMTP server address for sending email reports
# Options: 
#   - IP address (e.g., 10.101.1.1)
#   - Hostname (e.g., smtp.example.com)
#   - Leave empty to disable email sending
smtp_server = smtp.example.com

# SMTP server port number (integer)
# Common options:
#   - 25: Standard SMTP (no encryption)
#   - 587: SMTP with STARTTLS
#   - 465: SMTP over SSL/TLS
smtp_port = 25

# Enable TLS/SSL encryption for SMTP connection (boolean)
# Options: true, false
# Set to true if using port 587 or 465
smtp_use_tls = false

# SMTP authentication username (string)
# Leave empty if SMTP server doesn't require authentication
# Options: Any string or empty
smtp_auth_user = 

# SMTP authentication password (string)
# Leave empty if SMTP server doesn't require authentication
# Options: Any string or empty
smtp_auth_pass = 

# Recipient email address(es) for reports (string, required)
# Supports multiple email addresses separated by comma or semicolon
# Options: 
#   - Single email: admin@example.com
#   - Multiple emails (comma separated): admin@example.com, security@company.com, team@example.com
#   - Multiple emails (semicolon separated): admin@example.com; security@company.com; team@example.com
# Examples:
#   mail_to = admin@example.com
#   mail_to = admin@example.com, security@company.com, team@example.com
#   mail_to = admin@example.com; security@company.com; team@example.com
mail_to = admin@example.com

# Sender email address for reports (string, required)
# Options: Any valid email address
# This will appear as the "From" address in emails
mail_from = wazuh@example.com

# Email subject prefix (string)
# This text will be prepended to the email subject line
# Options: Any string
mail_subject_prefix = Leblebi Security Report

# ============================================================================
# LOGGING CONFIGURATION
# ============================================================================

# Logging level (string)
# Controls which log messages are written to log file
# Options:
#   - DEBUG: All messages (very verbose, for troubleshooting)
#   - INFO: Informational messages and above
#   - WARNING: Warning messages and errors only (default, recommended)
#   - ERROR: Only error messages
#   - CRITICAL: Only critical errors
# Recommended: WARNING for production (reduces log file size)
log_level = WARNING

# Log file path (string)
# Where application logs will be written
# Options: Any valid file path (directory must exist and be writable)
# Default: /var/log/leblebi/leblebi.log
log_file = /var/log/leblebi/leblebi.log

# ============================================================================
# LOCK FILE SETTINGS
# ============================================================================

# Lock file path (string)
# Prevents multiple instances of Leblebi from running simultaneously
# Options: Any valid file path
# Default: /var/run/leblebi_report.lock
lock_file = /var/run/leblebi_report.lock

# Lock file timeout in seconds (integer)
# How long to wait if another instance is running
# Options: Any positive integer (in seconds)
# Default: 3600 (1 hour)
lock_timeout = 3600

# ============================================================================
# WAZUH API CONFIGURATION (Optional)
# ============================================================================

# Enable Wazuh API integration (boolean)
# When enabled, Leblebi will collect additional data from Wazuh API:
#   - Agent health monitoring
#   - (Vulnerability intelligence feature has been removed)
#   - Rootcheck analysis
#   - System information
# Options: true, false
# Note: Alerts are ALWAYS read from alerts.json file, API is only for additional data
wazuh_api_enabled = false

# Wazuh API server hostname or IP address (string)
# Options: 
#   - IP address (e.g., 200.200.200.7)
#   - Hostname (e.g., wazuh-manager.example.com)
#   - localhost (if running on same server)
wazuh_api_host = localhost

# Wazuh API server port (integer)
# Default Wazuh API port is 55000
# Options: Any valid port number
wazuh_api_port = 55000

# Wazuh API protocol (string)
# Options:
#   - https: Secure connection (recommended)
#   - http: Unencrypted connection (not recommended)
wazuh_api_protocol = https

# Wazuh API username (string, required if API enabled)
# This is the Wazuh API user, not system user
# Options: Any valid Wazuh API username
wazuh_api_username = wazuh

# Wazuh API password (string, required if API enabled)
# Password for the Wazuh API user
# Options: Any string (keep secure!)
# IMPORTANT: Use environment variables for production: WAZUH_API_PASSWORD
wazuh_api_password = wazuh

# Verify SSL certificates for HTTPS connections (boolean)
# Options:
#   - true: Verify SSL certificates (recommended for production)
#   - false: Skip SSL verification (use for self-signed certificates)
# Default: false (for self-signed certificates)
wazuh_api_verify_ssl = false

# ============================================================================
# API-BASED DATA COLLECTION SETTINGS (Optional)
# ============================================================================
# These settings control which additional data is collected from Wazuh API
# Note: Alerts are ALWAYS read from alerts.json file (required)
# API is used only for additional data: agent health, rootcheck, etc.

# Enable agent health monitoring via API (boolean)
# Collects: agent status, disconnected agents, version distribution, OS distribution
# Options: true, false
use_api_for_agent_health = true

# Enable vulnerability data collection via API (boolean)
# NOTE: This feature has been removed from Leblebi
# Options: true, false
# use_api_for_vulnerabilities = true

# Enable rootcheck analysis via API (boolean)
# Collects: Rootcheck results detecting rootkits, malware, system integrity issues
# Options: true, false
use_api_for_rootcheck = true

# Enable manager status collection via API (boolean)
# Collects: Wazuh manager status and statistics
# Options: true, false
use_api_for_manager_status = true

# Enable SCA (Security Configuration Assessment) data collection (boolean)
# Collects: SCA policy compliance results and scores
# Options: true, false
use_api_for_sca = true

# Enable Syscheck (FIM - File Integrity Monitoring) data collection (boolean)
# Collects: File integrity monitoring findings and last scan times
# Options: true, false
use_api_for_syscheck = true

# Enable CIS-CAT compliance data collection (boolean)
# Collects: CIS-CAT benchmark compliance results
# Options: true, false
use_api_for_ciscat = true

# Enable enhanced Syscollector data collection (boolean)
# Collects: Hardware info, network interfaces, packages, ports, processes
# Options: true, false
use_api_for_syscollector = true

# ============================================================================
# REPORT PERIOD SETTINGS
# ============================================================================

# Report time period (string)
# Controls which alerts are included in the report based on timestamp
# Wazuh log structure: Today's logs in alerts.json, previous days in compressed files
# Format: Number of days followed by 'd' (e.g., 1d, 2d, 3d, 7d)
# Options:
#   - 1d: Today only (current day)
#   - 2d: Today + yesterday (2 days)
#   - 3d: Last 3 days
#   - 4d: Last 4 days
#   - 5d: Last 5 days
#   - 6d: Last 6 days
#   - 7d: Last 7 days (weekly)
#   - Any positive number followed by 'd' (e.g., 10d, 14d, 30d)
# Note: If logs for requested days are not available, the application will
#       process available logs and display a warning message
# Default: 1d
report_period = 1d

# ============================================================================
# PERFORMANCE SETTINGS FOR LARGE LOG FILES (200GB+ daily)
# ============================================================================
[performance]

# Maximum number of alerts to process (integer)
# Limits the total number of alerts processed to prevent memory issues
# Options:
#   - 0: Unlimited (process all alerts) - NOT RECOMMENDED for large files
#   - Any positive integer: Maximum alerts to process
# Recommended: 1000000 (1 million) for very large files (>1GB)
# This prevents "Killed" errors due to memory exhaustion
# Default: 1000000 (1 million alerts)
max_alerts_to_process = 1000000

# Enable sampling for very large datasets (boolean)
# When enabled, only a percentage of alerts will be processed
# Useful for extremely large log files (200GB+ daily or total >2GB)
# Options: true, false
# Default: true (enabled for better performance with large files)
sampling_enabled = true

# Sampling rate (float, 0.0-1.0)
# Percentage of alerts to process when sampling is enabled
# Options:
#   - 0.1: Process 10% of alerts (recommended for very large files)
#   - 0.25: Process 25% of alerts
#   - 0.5: Process 50% of alerts
#   - 1.0: Process 100% of alerts (same as sampling_enabled = false)
# Only used if sampling_enabled = true
# Default: 0.1 (10% - provides good balance between accuracy and performance)
sampling_rate = 0.1

# Use streaming JSON parser (boolean)
# When enabled, uses ijson library for memory-efficient streaming JSON parsing
# Requires: ijson package (pip install ijson)
# Options:
#   - true: Use streaming parser (recommended, memory-efficient)
#   - false: Use fallback method (less memory-efficient, works without ijson)
# Default: true (highly recommended for files >500MB)
# Note: If ijson is not installed, the application will use fallback method
#       but may consume more memory. Install with: pip install ijson
use_streaming_parser = true

# Memory limit in MB (integer)
# If memory usage exceeds this limit, sampling will be automatically enabled
# Options:
#   - 0: Disable memory limit checking (unlimited)
#   - Any positive integer: Memory limit in megabytes
# Default: 0 (disabled)
memory_limit_mb = 0

# Maximum number of agents to collect data from (integer)
# Limits the number of agents processed in parallel to prevent API overload
# Options:
#   - 0: Process all agents (may be slow with many agents)
#   - Any positive integer: Maximum agents to process
# Recommended: 50 for good balance between coverage and performance
# Default: 50
max_agents_to_collect = 50

# Maximum number of parallel workers for API collection (integer)
# Controls thread pool size for parallel API requests
# Options:
#   - 1-20: Number of parallel workers
# Recommended: 5-10 for most environments
# Default: 5
api_max_workers = 5

# API request timeout in seconds (integer)
# Maximum time to wait for API response
# Options:
#   - Any positive integer: Timeout in seconds
# Recommended: 30-120 seconds depending on network
# Default: 30
api_timeout = 30

# API collection timeout in seconds (integer)
# Maximum time to wait for parallel API collection tasks
# Options:
#   - Any positive integer: Timeout in seconds
# Recommended: 120-300 seconds for large agent counts
# Default: 120
api_collection_timeout = 120

# Limit per agent for data collection (integer)
# Maximum number of items to collect per agent per data type
# Options:
#   - Any positive integer: Limit per agent
# Recommended: 10-50 depending on data type
# Default: 10
api_limit_per_agent = 10

# Minimum alert level for attack timeline (integer)
# Minimum alert level to include in attack timeline analysis
# Options:
#   - 0-15: Alert level threshold
# Recommended: 12 for security-focused analysis
# Default: 12
attack_timeline_min_level = 12

# Attack timeline limit (integer)
# Maximum number of alerts to include in attack timeline
# Options:
#   - Any positive integer: Maximum alerts
# Recommended: 500-1000 for detailed analysis
# Default: 500
attack_timeline_limit = 500

